!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery)}(function(t){"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){var n,o,r=this.length>>>0,i=!1;for(1<arguments.length&&(o=e,i=!0),n=0;r>n;++n)this.hasOwnProperty(n)&&(i?o=t(o,this[n],n,this):(o=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return o});var e,n="function"==typeof define&&define.amd,o=function(e){var n="Comic Sans MS"===e?"Courier New":"Comic Sans MS",o=t("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),r=o.css("fontFamily",n).width(),i=o.css("fontFamily",e+","+n).width();return o.remove(),r!==i},r={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(t.fn.jquery),isSupportAmd:n,hasCodeMirror:n?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:o},i=function(){var e=function(t){return function(e){return t===e}},n=function(t,e){return t===e},o=function(){return!0},r=function(){return!1},i=function(t){return function(){return!t.apply(t,arguments)}},a=function(t){return t},l=0,s=function(t){var e=++l+"";return t?t+e:e},d=function(e){var n=t(document);return{top:e.top+n.scrollTop(),left:e.left+n.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}},c=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e};return{eq:e,eq2:n,ok:o,fail:r,not:i,self:a,uniqueId:s,rect2bnd:d,invertObject:c}}(),a=function(){var t=function(t){return t[0]},e=function(t){return t[t.length-1]},n=function(t){return t.slice(0,t.length-1)},o=function(t){return t.slice(1)},r=function(t,e){var n=t.indexOf(e);return-1===n?null:t[n+1]},a=function(t,e){var n=t.indexOf(e);return-1===n?null:t[n-1]},l=function(t,e){return e=e||i.self,t.reduce(function(t,n){return t+e(n)},0)},s=function(t){for(var e=[],n=-1,o=t.length;++n<o;)e[n]=t[n];return e},d=function(n,r){if(!n.length)return[];var i=o(n);return i.reduce(function(t,n){var o=e(t);return r(e(o),n)?o[o.length]=n:t[t.length]=[n],t},[[t(n)]])},c=function(t){for(var e=[],n=0,o=t.length;o>n;n++)t[n]&&e.push(t[n]);return e};return{head:t,last:e,initial:n,tail:o,prev:a,next:r,sum:l,from:s,compact:c,clusterBy:d}}(),l=function(){var e=function(e){return e&&t(e).hasClass("note-editable")},n=function(e){return e&&t(e).hasClass("note-control-sizing")},o=function(e){var n;if(e.hasClass("note-air-editor")){var o=a.last(e.attr("id").split("-"));return n=function(e){return function(){return t(e+o)}},{editor:function(){return e},editable:function(){return e},popover:n("#note-popover-"),handle:n("#note-handle-"),dialog:n("#note-dialog-")}}return n=function(t){return function(){return e.find(t)}},{editor:function(){return e},dropzone:n(".note-dropzone"),toolbar:n(".note-toolbar"),editable:n(".note-editable"),codable:n(".note-codable"),statusbar:n(".note-statusbar"),popover:n(".note-popover"),handle:n(".note-handle"),dialog:n(".note-dialog")}},s=function(t){return function(e){return e&&e.nodeName===t}},d=function(t){return t&&/^DIV|^P|^LI|^H[1-7]/.test(t.nodeName)},c=function(t){return t&&/^UL|^OL/.test(t.nodeName)},u=function(t){return t&&/^TD|^TH/.test(t.nodeName)},f=function(t,n){for(;t;){if(n(t))return t;if(e(t))break;t=t.parentNode}return null},h=function(t,e){e=e||i.fail;var n=[];return f(t,function(t){return n.push(t),e(t)}),n},v=function(e,n){for(var o=h(e),r=n;r;r=r.parentNode)if(t.inArray(r,o)>-1)return r;return null},p=function(t,e){var n=[],o=!1,r=!1;return function i(a){if(a){if(a===t&&(o=!0),o&&!r&&n.push(a),a===e)return void(r=!0);for(var l=0,s=a.childNodes.length;s>l;l++)i(a.childNodes[l])}}(v(t,e)),n},g=function(t,e){e=e||i.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.previousSibling;return n},m=function(t,e){e=e||i.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.nextSibling;return n},b=function(t,e){var n=[];return e=e||i.ok,function o(r){t!==r&&e(r)&&n.push(r);for(var i=0,a=r.childNodes.length;a>i;i++)o(r.childNodes[i])}(t),n},y=function(t,e){var n=e.nextSibling,o=e.parentNode;return n?o.insertBefore(t,n):o.appendChild(t),t},C=function(e,n){return t.each(n,function(t,n){e.appendChild(n)}),e},w=s("#text"),k=function(t){return w(t)?t.nodeValue.length:t.childNodes.length},T=function(t){return 0===t.offset||t.offset===k(t.node)},x=function(t){for(var e=0;t=t.previousSibling;)e+=1;return e},F=function(t){return t&&t.childNodes&&t.childNodes.length},S=function(t){var n=t.node,o=t.offset;if(0===o)return e(n)?null:{node:n.parentNode,offset:x(n)};if(F(n)){var r=n.childNodes[o-1];return{node:r,offset:k(r)}}return{node:n,offset:o-1}},M=function(e,n){var o=a.initial(h(n,i.eq(e)));return t.map(o,x).reverse()},N=function(t,e){for(var n=t,o=0,r=e.length;r>o;o++)n=n.childNodes[e[o]];return n},R=function(t,e){if(0===e)return t;if(e>=k(t))return t.nextSibling;if(w(t))return t.splitText(e);var n=t.childNodes[e];return t=y(t.cloneNode(!1),t),C(t,m(n))},A=function(t,e,n){var o=h(e,i.eq(t));return 1===o.length?R(e,n):o.reduce(function(t,o){var r=o.cloneNode(!1);return y(r,o),t===e&&(t=R(t,n)),C(r,m(t)),r})},E=function(t,e){if(t&&t.parentNode){if(t.removeNode)return t.removeNode(e);var n=t.parentNode;if(!e){var o,r,i=[];for(o=0,r=t.childNodes.length;r>o;o++)i.push(t.childNodes[o]);for(o=0,r=i.length;r>o;o++)n.insertBefore(i[o],t)}n.removeChild(t)}},D=function(t){return l.isTextarea(t[0])?t.val():t.html()};return{blank:r.isMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:e,isControlSizing:n,buildLayoutInfo:o,isText:w,isPara:d,isList:c,isTable:s("TABLE"),isCell:u,isAnchor:s("A"),isDiv:s("DIV"),isLi:s("LI"),isSpan:s("SPAN"),isB:s("B"),isU:s("U"),isS:s("S"),isI:s("I"),isImg:s("IMG"),isTextarea:s("TEXTAREA"),length:k,isEdgeBP:T,prevBP:S,ancestor:f,listAncestor:h,listNext:m,listPrev:g,listDescendant:b,commonAncestor:v,listBetween:p,insertAfter:y,position:x,makeOffsetPath:M,fromOffsetPath:N,splitTree:A,remove:E,html:D}}(),s={version:"0.5.3",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0,autoFormatOnStart:!1},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","superscript","subscript","strikethrough","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],fontSizes:["8","9","10","11","12","14","18","24","36"],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,onCreateLink:function(t){return-1!==t.indexOf("@")&&-1===t.indexOf(":")?t="mailto:"+t:-1===t.indexOf("://")&&(t="http://"+t),t},keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}},d=function(){var e=function(e){return t.Deferred(function(n){t.extend(new FileReader,{onload:function(t){var e=t.target.result;n.resolve(e)},onerror:function(){n.reject(this)}}).readAsDataURL(e)}).promise()},n=function(e){return t.Deferred(function(n){t("<img class='img-responsive'>").one("load",function(){n.resolve(t(this))}).one("error abort",function(){n.reject(t(this))}).css({display:"none"}).appendTo(document.body).attr("src",e)}).promise()};return{readFileAsDataURL:e,createImage:n}}(),c={isEdit:function(t){return-1!==[8,9,13,32].indexOf(t)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},u=function(){var e=function(e,n){if(r.jqueryVersion<1.9){var o={};return t.each(n,function(t,n){o[n]=e.css(n)}),o}return e.css.call(e,n)};this.stylePara=function(e,n){t.each(e.nodes(l.isPara),function(e,o){t(o).css(n)})},this.current=function(n,o){var r=t(l.isText(n.sc)?n.sc.parentNode:n.sc),i=["font-family","font-size","text-align","list-style-type","line-height"],a=e(r,i)||{};if(a["font-size"]=parseInt(a["font-size"],10),a["font-bold"]=document.queryCommandState("bold")?"bold":"normal",a["font-italic"]=document.queryCommandState("italic")?"italic":"normal",a["font-underline"]=document.queryCommandState("underline")?"underline":"normal",a["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",a["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",a["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",n.isOnList()){var s=["circle","disc","disc-leading-zero","square"],d=t.inArray(a["list-style-type"],s)>-1;a["list-style"]=d?"unordered":"ordered"}else a["list-style"]="none";var c=l.ancestor(n.sc,l.isPara);if(c&&c.style["line-height"])a["line-height"]=c.style.lineHeight;else{var u=parseInt(a["line-height"],10)/parseInt(a["font-size"],10);a["line-height"]=u.toFixed(1)}return a.image=l.isImg(o)&&o,a.anchor=n.isOnAnchor()&&l.ancestor(n.sc,l.isAnchor),a.aAncestor=l.listAncestor(n.sc,l.isEditable),a.range=n,a}},f=function(){var e=!!document.createRange,n=function(t,e){var n,o,r=t.parentElement(),i=document.body.createTextRange(),s=a.from(r.childNodes);for(n=0;n<s.length;n++)if(!l.isText(s[n])){if(i.moveToElementText(s[n]),i.compareEndPoints("StartToStart",t)>=0)break;o=s[n]}if(0!==n&&l.isText(s[n-1])){var d=document.body.createTextRange(),c=null;d.moveToElementText(o||r),d.collapse(!o),c=o?o.nextSibling:r.firstChild;var u=t.duplicate();u.setEndPoint("StartToStart",d);for(var f=u.text.replace(/[\r\n]/g,"").length;f>c.nodeValue.length&&c.nextSibling;)f-=c.nodeValue.length,c=c.nextSibling;c.nodeValue,e&&c.nextSibling&&l.isText(c.nextSibling)&&f===c.nodeValue.length&&(f-=c.nodeValue.length,c=c.nextSibling),r=c,n=f}return{cont:r,offset:n}},o=function(t){var e=function(t,n){var o,r;if(l.isText(t)){var s=l.listPrev(t,i.not(l.isText)),d=a.last(s).previousSibling;o=d||t.parentNode,n+=a.sum(a.tail(s),l.length),r=!d}else{if(o=t.childNodes[n]||t,l.isText(o))return e(o,n);n=0,r=!1}return{cont:o,collapseToStart:r,offset:n}},n=document.body.createTextRange(),o=e(t.cont,t.offset);return n.moveToElementText(o.cont),n.collapse(o.collapseToStart),n.moveStart("character",o.offset),n},r=function(n,s,d,c){this.sc=n,this.so=s,this.ec=d,this.eo=c;var u=function(){if(e){var t=document.createRange();return t.setStart(n,s),t.setEnd(d,c),t}var r=o({cont:n,offset:s});return r.setEndPoint("EndToEnd",o({cont:d,offset:c})),r};this.getBPs=function(){return{sc:n,so:s,ec:d,eo:c}},this.getStartBP=function(){return{node:n,offset:s}},this.getEndBP=function(){return{node:d,offset:c}},this.select=function(){var t=u();if(e){var n=document.getSelection();n.rangeCount>0&&n.removeAllRanges(),n.addRange(t)}else t.select()},this.nodes=function(e){e=e||i.ok;var o=l.listBetween(n,d),r=a.compact(t.map(o,function(t){return l.ancestor(t,e)}));return t.map(a.clusterBy(r,i.eq2),a.head)},this.commonAncestor=function(){return l.commonAncestor(n,d)},this.expand=function(t){var e=l.ancestor(n,t),o=l.ancestor(d,t);if(!e&&!o)return new r(n,s,d,c);var i=this.getBPs();return e&&(i.sc=e,i.so=0),o&&(i.ec=o,i.eo=l.length(o)),new r(i.sc,i.so,i.ec,i.eo)},this.collapse=function(t){return t?new r(n,s,n,s):new r(d,c,d,c)},this.splitText=function(){var t=n===d,e=this.getBPs();return l.isText(d)&&!l.isEdgeBP(this.getEndBP())&&d.splitText(c),l.isText(n)&&!l.isEdgeBP(this.getStartBP())&&(e.sc=n.splitText(s),e.so=0,t&&(e.ec=e.sc,e.eo=c-s)),new r(e.sc,e.so,e.ec,e.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var e=this.splitText(),n=l.prevBP(e.getStartBP());return t.each(e.nodes(),function(t,e){l.remove(e,!l.isPara(e))}),new r(n.node,n.offset,n.node,n.offset)};var f=function(t){return function(){var e=l.ancestor(n,t);return!!e&&e===l.ancestor(d,t)}};this.isOnEditable=f(l.isEditable),this.isOnList=f(l.isList),this.isOnAnchor=f(l.isAnchor),this.isOnCell=f(l.isCell),this.isCollapsed=function(){return n===d&&s===c},this.insertNode=function(n){var o=u();if(e)o.insertNode(n);else{var r="node-insert-node-target";n.id=r,o.pasteHTML(n.outerHTML),n=t("#"+r)[0]}return n},this.toString=function(){var t=u();return e?t.toString():t.text},this.bookmark=function(t){return{s:{path:l.makeOffsetPath(t,n),offset:s},e:{path:l.makeOffsetPath(t,d),offset:c}}},this.getClientRects=function(){var t=u();return t.getClientRects()}};return{create:function(t,o,i,a){if(arguments.length)2===arguments.length&&(i=t,a=o);else if(e){var l=document.getSelection();if(0===l.rangeCount)return null;var s=l.getRangeAt(0);t=s.startContainer,o=s.startOffset,i=s.endContainer,a=s.endOffset}else{var d=document.selection.createRange(),c=d.duplicate();c.collapse(!1);var u=d;u.collapse(!0);var f=n(u,!0),h=n(c,!1);t=f.cont,o=f.offset,i=h.cont,a=h.offset}return new r(t,o,i,a)},createFromNode:function(t){return this.create(t,0,t,1)},createFromBookmark:function(t,e){var n=l.fromOffsetPath(t,e.s.path),o=e.s.offset,i=l.fromOffsetPath(t,e.e.path),a=e.e.offset;return new r(n,o,i,a)}}}(),h=function(){this.tab=function(t,e){var n=l.ancestor(t.commonAncestor(),l.isCell),o=l.ancestor(n,l.isTable),r=l.listDescendant(o,l.isCell),i=a[e?"prev":"next"](r,n);i&&f.create(i,0).select()},this.createTable=function(e,n){for(var o,r=[],i=0;e>i;i++)r.push("<td>"+l.blank+"</td>");o=r.join("");for(var a,s=[],d=0;n>d;d++)s.push("<tr>"+o+"</tr>");a=s.join("");var c='<table class="table table-bordered">'+a+"</table>";return t(c)[0]}},v=function(){var e=new u,n=new h;this.saveRange=function(t){t.focus(),t.data("range",f.create())},this.restoreRange=function(t){var e=t.data("range");e&&(e.select(),t.focus())},this.currentStyle=function(t){var n=f.create();return n?n.isOnEditable()&&e.current(n,t):!1},this.undo=function(t){t.data("NoteHistory").undo(t)},this.redo=function(t){t.data("NoteHistory").redo(t)};for(var o=this.recordUndo=function(t){t.data("NoteHistory").recordUndo(t)},i=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],s=0,c=i.length;c>s;s++)this[i[s]]=function(t){return function(e,n){o(e),document.execCommand(t,!1,n)}}(i[s]);var v=function(e,n,r){o(e);var i=new Array(r+1).join("&nbsp;");n.insertNode(t('<span id="noteTab">'+i+"</span>")[0]);var a=t("#noteTab").removeAttr("id");n=f.create(a[0],1),n.select(),l.remove(a[0])};this.tab=function(t,e){var o=f.create();o.isCollapsed()&&o.isOnCell()?n.tab(o):v(t,o,e.tabsize)},this.untab=function(){var t=f.create();t.isCollapsed()&&t.isOnCell()&&n.tab(t,!0)},this.insertImage=function(t,e){d.createImage(e).then(function(e){o(t),e.css({display:"",width:Math.min(t.width(),e.width())}),f.create().insertNode(e[0])}).fail(function(){var e=t.data("callbacks");e.onImageUploadError&&e.onImageUploadError()})},this.insertVideo=function(e,n){o(e);var r,i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,a=n.match(i),l=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/,s=n.match(l),d=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,c=n.match(d),u=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,h=n.match(u),v=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,p=n.match(v),g=/\/\/v\.youku\.com\/v_show\/id_(\w+)\.html/,m=n.match(g);if(a&&11===a[2].length){var b=a[2];r=t("<iframe>").attr("src","//www.youtube.com/embed/"+b).attr("width","640").attr("height","360")}else s&&s[0].length?r=t("<iframe>").attr("src",s[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):c&&c[0].length?r=t("<iframe>").attr("src",c[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):h&&h[3].length?r=t("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360"):p&&p[2].length?r=t("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+p[2]).attr("width","640").attr("height","360"):m&&m[1].length&&(r=t("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+m[1]));r&&(r.attr("frameborder",0),f.create().insertNode(r[0]))},this.formatBlock=function(t,e){o(t),e=r.isMSIE?"<"+e+">":e,document.execCommand("FormatBlock",!1,e)},this.formatPara=function(t){this.formatBlock(t,"P")};for(var s=1;6>=s;s++)this["formatH"+s]=function(t){return function(e){this.formatBlock(e,"H"+t)}}(s);this.fontSize=function(t,e){o(t),document.execCommand("fontSize",!1,3),r.isFF?t.find("font[size=3]").removeAttr("size").css("font-size",e+"px"):t.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",e+"px")},this.lineHeight=function(t,n){o(t),e.stylePara(f.create(),{lineHeight:n})},this.unlink=function(t){var e=f.create();if(e.isOnAnchor()){o(t);var n=l.ancestor(e.sc,l.isAnchor);e=f.createFromNode(n),e.select(),document.execCommand("unlink")}},this.createLink=function(e,n,r){var i=n.url,a=n.text,l=n.newWindow,s=n.range;o(e),r.onCreateLink&&(i=r.onCreateLink(i)),s=s.deleteContents();var d=s.insertNode(t("<A>"+a+"</A>")[0]);t(d).attr({href:i,target:l?"_blank":""}),s=f.createFromNode(d),s.select()},this.getLinkInfo=function(e){e.focus();var n=f.create().expand(l.isAnchor),o=t(a.head(n.nodes(l.isAnchor)));return{range:n,text:n.toString(),isNewWindow:o.length?"_blank"===o.attr("target"):!0,url:o.length?o.attr("href"):""}},this.getVideoInfo=function(t){t.focus();var e=f.create();if(e.isOnAnchor()){var n=l.ancestor(e.sc,l.isAnchor);e=f.createFromNode(n)}return{text:e.toString()}},this.color=function(t,e){var n=JSON.parse(e),r=n.foreColor,i=n.backColor;o(t),r&&document.execCommand("foreColor",!1,r),i&&document.execCommand("backColor",!1,i)},this.insertTable=function(t,e){o(t);var r=e.split("x");f.create().insertNode(n.createTable(r[0],r[1]))},this.floatMe=function(t,e,n){o(t),n.css("float",e)},this.resize=function(t,e,n){o(t),n.css({width:t.width()*e+"px",height:""})},this.resizeTo=function(t,e,n){var o;if(n){var r=t.y/t.x,i=e.data("ratio");o={width:i>r?t.x:t.y/i,height:i>r?t.x*i:t.y}}else o={width:t.x,height:t.y};e.css(o)},this.removeMedia=function(t,e,n){o(t),n.detach()}},p=function(){var t=[],e=[],n=function(t){var e=t[0],n=f.create();return{contents:t.html(),bookmark:n.bookmark(e),scrollTop:t.scrollTop()}},o=function(t,e){t.html(e.contents).scrollTop(e.scrollTop),f.createFromBookmark(t[0],e.bookmark).select()};this.undo=function(r){var i=n(r);t.length&&(o(r,t.pop()),e.push(i))},this.redo=function(r){var i=n(r);e.length&&(o(r,e.pop()),t.push(i))},this.recordUndo=function(o){e=[],t.push(n(o))}},g=function(){this.update=function(e,n){var o=function(e,n){e.find(".dropdown-menu li a").each(function(){var e=t(this).data("value")+""==n+"";this.className=e?"checked":""})},r=function(t,n){var o=e.find(t);o.toggleClass("active",n())},i=e.find(".note-fontname");if(i.length){var l=n["font-family"];l&&(l=a.head(l.split(",")),l=l.replace(/\'/g,""),i.find(".note-current-fontname").text(l),o(i,l))}var s=e.find(".note-fontsize");s.find(".note-current-fontsize").text(n["font-size"]),o(s,parseFloat(n["font-size"]));var d=e.find(".note-height");o(d,parseFloat(n["line-height"])),r('button[data-event="bold"]',function(){return"bold"===n["font-bold"]}),r('button[data-event="italic"]',function(){return"italic"===n["font-italic"]}),r('button[data-event="underline"]',function(){return"underline"===n["font-underline"]}),r('button[data-event="strikethrough"]',function(){return"strikethrough"===n["font-strikethrough"]}),r('button[data-event="superscript"]',function(){return"superscript"===n["font-superscript"]}),r('button[data-event="subscript"]',function(){return"subscript"===n["font-subscript"]}),r('button[data-event="justifyLeft"]',function(){return"left"===n["text-align"]||"start"===n["text-align"]}),r('button[data-event="justifyCenter"]',function(){return"center"===n["text-align"]}),r('button[data-event="justifyRight"]',function(){return"right"===n["text-align"]}),r('button[data-event="justifyFull"]',function(){return"justify"===n["text-align"]}),r('button[data-event="insertUnorderedList"]',function(){return"unordered"===n["list-style"]}),r('button[data-event="insertOrderedList"]',function(){return"ordered"===n["list-style"]})},this.updateRecentColor=function(e,n,o){var r=t(e).closest(".note-color"),i=r.find(".note-recent-color"),a=JSON.parse(i.attr("data-value"));a[n]=o,i.attr("data-value",JSON.stringify(a));var l="backColor"===n?"background-color":"color";i.find("i").css(l,o)}},m=function(){var t=new g;this.update=function(e,n){t.update(e,n)},this.updateRecentColor=function(e,n,o){t.updateRecentColor(e,n,o)},this.activate=function(t){t.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(t){t.find("button").not('button[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(t,e){var n=t.find('button[data-event="fullscreen"]');n.toggleClass("active",e)},this.updateCodeview=function(t,e){var n=t.find('button[data-event="codeview"]');n.toggleClass("active",e)}},b=function(){var e=new g,n=function(e,n){var o=t(e),r=n?o.offset():o.position(),i=o.outerHeight(!0);return{left:r.left,top:r.top+i}},o=function(t,e){t.css({display:"block",left:e.left,top:e.top})},r=20;this.update=function(l,s,d){e.update(l,s);var c=l.find(".note-link-popover");if(s.anchor){var u=c.find("a"),f=t(s.anchor).attr("href");u.attr("href",f).html(f),o(c,n(s.anchor,d))}else c.hide();var h=l.find(".note-image-popover");s.image?o(h,n(s.image,d)):h.hide();var v=l.find(".note-air-popover");if(d&&!s.range.isCollapsed()){var p=i.rect2bnd(a.last(s.range.getClientRects()));o(v,{left:Math.max(p.left+p.width/2-r,0),top:p.top+p.height})}else v.hide()},this.updateRecentColor=function(t,n,o){e.updateRecentColor(t,n,o)},this.hide=function(t){t.children().hide()}},y=function(){this.update=function(e,n,o){var r=e.find(".note-control-selection");if(n.image){var i=t(n.image),a=o?i.offset():i.position(),l={w:i.outerWidth(!0),h:i.outerHeight(!0)};r.css({display:"block",left:a.left,top:a.top,width:l.w,height:l.h}).data("target",n.image);var s=l.w+"x"+l.h;r.find(".note-control-selection-info").text(s)}else r.hide()},this.hide=function(t){t.children().hide()}},C=function(){var e=function(t,e){t.toggleClass("disabled",!e),t.attr("disabled",!e)};this.showImageDialog=function(n,o){return t.Deferred(function(t){var n=o.find(".note-image-dialog"),r=o.find(".note-image-input"),i=o.find(".note-image-url"),a=o.find(".note-image-btn");n.one("shown.bs.modal",function(){r.replaceWith(r.clone().on("change",function(){t.resolve(this.files),n.modal("hide")})),a.click(function(e){e.preventDefault(),t.resolve(i.val()),n.modal("hide")}),i.on("keyup paste",function(t){var n;n="paste"===t.type?t.originalEvent.clipboardData.getData("text"):i.val(),e(a,n)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){r.off("change"),i.off("keyup paste"),a.off("click"),"pending"===t.state()&&t.reject()}).modal("show")})},this.showVideoDialog=function(n,o,r){return t.Deferred(function(t){var n=o.find(".note-video-dialog"),i=n.find(".note-video-url"),a=n.find(".note-video-btn");n.one("shown.bs.modal",function(){i.val(r.text).keyup(function(){e(a,i.val())}).trigger("keyup").trigger("focus"),a.click(function(e){e.preventDefault(),t.resolve(i.val()),n.modal("hide")})}).one("hidden.bs.modal",function(){i.off("keyup"),a.off("click"),"pending"===t.state()&&t.reject()}).modal("show")})},this.showLinkDialog=function(n,o,r){return t.Deferred(function(t){var n=o.find(".note-link-dialog"),i=n.find(".note-link-text"),a=n.find(".note-link-url"),l=n.find(".note-link-btn"),s=n.find("input[type=checkbox]");n.one("shown.bs.modal",function(){i.val(r.text),i.keyup(function(){r.text=i.val()}),r.url||(r.url=r.text,e(l,r.text)),a.keyup(function(){e(l,a.val()),r.text||i.val(a.val())}).val(r.url).trigger("focus").trigger("select"),s.prop("checked",r.newWindow),l.one("click",function(e){e.preventDefault(),t.resolve({range:r.range,url:a.val(),text:i.val(),newWindow:s.is(":checked")}),n.modal("hide")})}).one("hidden.bs.modal",function(){i.off("keyup"),a.off("keyup"),l.off("click"),"pending"===t.state()&&t.reject()}).modal("show")}).promise()},this.showHelpDialog=function(e,n){return t.Deferred(function(t){var e=n.find(".note-help-dialog");e.one("hidden.bs.modal",function(){t.resolve()}).modal("show")}).promise()}};r.hasCodeMirror&&(r.isSupportAmd?require(["CodeMirror"],function(t){e=t}):e=window.CodeMirror);var w=function(){var n=t(window),o=t(document),i=t("html, body"),s=new v,u=new m,f=new b,h=new y,g=new C,w=function(e){var n=t(e).closest(".note-editor, .note-air-editor, .note-air-layout");if(!n.length)return null;var o;return o=n.is(".note-editor, .note-air-editor")?n:t("#note-editor-"+a.last(n.attr("id").split("-"))),l.buildLayoutInfo(o)},k=function(e,n){s.restoreRange(e);var o=e.data("callbacks");o.onImageUpload?o.onImageUpload(n,s,e):t.each(n,function(t,n){d.readFileAsDataURL(n).then(function(t){s.insertImage(e,t)}).fail(function(){o.onImageUploadError&&o.onImageUploadError()})})},T={showLinkDialog:function(t){var e=t.editor(),n=t.dialog(),o=t.editable(),r=s.getLinkInfo(o),i=e.data("options");s.saveRange(o),g.showLinkDialog(o,n,r).then(function(e){s.restoreRange(o),s.createLink(o,e,i),f.hide(t.popover())}).fail(function(){s.restoreRange(o)})},showImageDialog:function(t){var e=t.dialog(),n=t.editable();s.saveRange(n),g.showImageDialog(n,e).then(function(t){s.restoreRange(n),"string"==typeof t?s.insertImage(n,t):k(n,t)}).fail(function(){s.restoreRange(n)})},showVideoDialog:function(t){var e=t.dialog(),n=t.editable(),o=s.getVideoInfo(n);s.saveRange(n),g.showVideoDialog(n,e,o).then(function(t){s.restoreRange(n),s.insertVideo(n,t)}).fail(function(){s.restoreRange(n)})},showHelpDialog:function(t){var e=t.dialog(),n=t.editable();s.saveRange(n),g.showHelpDialog(n,e).then(function(){s.restoreRange(n)})},fullscreen:function(t){var e=t.editor(),o=t.toolbar(),r=t.editable(),a=t.codable(),l=e.data("options"),s=function(t){e.css("width",t.w),r.css("height",t.h),a.css("height",t.h),a.data("cmeditor")&&a.data("cmeditor").setsize(null,t.h)};e.toggleClass("fullscreen");var d=e.hasClass("fullscreen");d?(r.data("orgheight",r.css("height")),n.on("resize",function(){s({w:n.width(),h:n.height()-o.outerHeight()})}).trigger("resize"),i.css("overflow","hidden")):(n.off("resize"),s({w:l.width||"",h:r.data("orgheight")}),i.css("overflow","visible")),u.updateFullscreen(o,d)},codeview:function(t){var n,o,i=t.editor(),a=t.toolbar(),s=t.editable(),d=t.codable(),c=t.popover(),h=i.data("options");i.toggleClass("codeview");var v=i.hasClass("codeview");v?(d.val(s.html()),d.height(s.height()),u.deactivate(a),f.hide(c),d.focus(),r.hasCodeMirror&&(n=e.fromTextArea(d[0],h.codemirror),h.codemirror.tern&&(o=new e.TernServer(h.codemirror.tern),n.ternServer=o,n.on("cursorActivity",function(t){o.updateArgHints(t)})),n.setSize(null,s.outerHeight()),h.codemirror.autoFormatOnStart&&n.autoFormatRange&&n.autoFormatRange({line:0,ch:0},{line:n.lineCount(),ch:n.getTextArea().value.length}),d.data("cmEditor",n))):(r.hasCodeMirror&&(n=d.data("cmEditor"),d.val(n.getValue()),n.toTextArea()),s.html(d.val()||l.emptyPara),s.height(h.height?d.height():"auto"),u.activate(a),s.focus()),u.updateCodeview(t.toolbar(),v)}},x=function(t){l.isImg(t.target)&&t.preventDefault()},F=function(t){setTimeout(function(){var e=w(t.currentTarget||t.target),n=s.currentStyle(t.target);
if(n){var o=e.editor().data("options").airMode;o||u.update(e.toolbar(),n),f.update(e.popover(),n,o),h.update(e.handle(),n,o)}},0)},S=function(t){var e=w(t.currentTarget||t.target);f.hide(e.popover()),h.hide(e.handle())},M=function(t){var e=t.originalEvent.clipboardData;if(e&&e.items&&e.items.length){var n=w(t.currentTarget||t.target),o=a.head(e.items),r="file"===o.kind&&-1!==o.type.indexOf("image/");r&&k(n.editable(),[o.getAsFile()])}},N=function(e){if(l.isControlSizing(e.target)){e.preventDefault(),e.stopPropagation();var n=w(e.target),r=n.handle(),i=n.popover(),a=n.editable(),d=n.editor(),c=r.find(".note-control-selection").data("target"),u=t(c),v=u.offset(),p=o.scrollTop(),g=d.data("options").airMode;o.on("mousemove",function(t){s.resizeTo({x:t.clientX-v.left,y:t.clientY-(v.top-p)},u,!t.shiftKey),h.update(r,{image:c},g),f.update(i,{image:c},g)}).one("mouseup",function(){o.off("mousemove")}),u.data("ratio")||u.data("ratio",u.height()/u.width()),s.recordUndo(a)}},R=function(e){var n=t(e.target).closest("[data-event]");n.length&&e.preventDefault()},A=function(e){var n=t(e.target).closest("[data-event]");if(n.length){var o=n.attr("data-event"),r=n.attr("data-value"),i=w(e.target);e.preventDefault();var l;if(-1!==t.inArray(o,["resize","floatMe","removeMedia"])){var d=i.handle().find(".note-control-selection");l=t(d.data("target"))}if(s[o]){var c=i.editable();c.trigger("focus"),s[o](c,r,l)}else T[o]&&T[o].call(this,i);if(-1!==t.inArray(o,["backColor","foreColor"])){var h=i.editor().data("options",h),v=h.airMode?f:u;v.updateRecentColor(a.head(n),o,r)}F(e)}},E=24,D=function(t){t.preventDefault(),t.stopPropagation();var e=w(t.target).editable(),n=e.offset().top-o.scrollTop(),r=w(t.currentTarget||t.target),i=r.editor().data("options");o.on("mousemove",function(t){var o=t.clientY-(n+E);o=i.minHeight>0?Math.max(o,i.minHeight):o,o=i.maxHeight>0?Math.min(o,i.maxHeight):o,e.height(o)}).one("mouseup",function(){o.off("mousemove")})},L=18,H=function(e,n){var o,r=t(e.target.parentNode),i=r.next(),a=r.find(".note-dimension-picker-mousecatcher"),l=r.find(".note-dimension-picker-highlighted"),s=r.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var d=t(e.target).offset();o={x:e.pageX-d.left,y:e.pageY-d.top}}else o={x:e.offsetX,y:e.offsetY};var c={c:Math.ceil(o.x/L)||1,r:Math.ceil(o.y/L)||1};l.css({width:c.c+"em",height:c.r+"em"}),a.attr("data-value",c.c+"x"+c.r),3<c.c&&c.c<n.insertTableMaxSize.col&&s.css({width:c.c+1+"em"}),3<c.r&&c.r<n.insertTableMaxSize.row&&s.css({height:c.r+1+"em"}),i.html(c.c+" x "+c.r)},I=function(e){var n=t(),r=e.dropzone,i=e.dropzone.find(".note-dropzone-message");o.on("dragenter",function(t){var o=e.editor.hasClass("codeview");o||n.length||(e.editor.addClass("dragover"),r.width(e.editor.width()),r.height(e.editor.height()),i.text("Drag Image Here")),n=n.add(t.target)}).on("dragleave",function(t){n=n.not(t.target),n.length||e.editor.removeClass("dragover")}).on("drop",function(){n=t(),e.editor.removeClass("dragover")}),r.on("dragenter",function(){r.addClass("hover"),i.text("Drop Image")}).on("dragleave",function(){r.removeClass("hover"),i.text("Drag Image Here")}),r.on("drop",function(t){t.preventDefault();var e=t.originalEvent.dataTransfer;if(e&&e.files){var n=w(t.currentTarget||t.target);n.editable().focus(),k(n.editable(),e.files)}}).on("dragover",!1)};this.bindKeyMap=function(t,e){var n=t.editor,o=t.editable;t=w(o),o.on("keydown",function(r){var i=[];r.metaKey&&i.push("CMD"),r.ctrlKey&&!r.altKey&&i.push("CTRL"),r.shiftKey&&i.push("SHIFT");var a=c.nameFromCode[r.keyCode];a&&i.push(a);var l=e[i.join("+")];l?(r.preventDefault(),s[l]?s[l](o,n.data("options")):T[l]&&T[l].call(this,t)):c.isEdit(r.keyCode)&&s.recordUndo(o)})},this.attach=function(t,e){this.bindKeyMap(t,e.keyMap[r.isMac?"mac":"pc"]),t.editable.on("mousedown",x),t.editable.on("keyup mouseup",F),t.editable.on("scroll",S),t.editable.on("paste",M),t.handle.on("mousedown",N),t.popover.on("click",A),t.popover.on("mousedown",R),e.airMode||(e.disableDragAndDrop||I(t),t.toolbar.on("click",A),t.toolbar.on("mousedown",R),e.disableResizeEditor||t.statusbar.on("mousedown",D));var n=e.airMode?t.popover:t.toolbar,o=n.find(".note-dimension-picker-mousecatcher");if(o.css({width:e.insertTableMaxSize.col+"em",height:e.insertTableMaxSize.row+"em"}).on("mousemove",function(t){H(t,e)}),t.editor.data("options",e),e.styleWithSpan&&!r.isMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)},0),t.editable.data("NoteHistory",new p),e.onenter&&t.editable.keypress(function(t){t.keyCode===c.ENTER&&e.onenter(t)}),e.onfocus&&t.editable.focus(e.onfocus),e.onblur&&t.editable.blur(e.onblur),e.onkeyup&&t.editable.keyup(e.onkeyup),e.onkeydown&&t.editable.keydown(e.onkeydown),e.onpaste&&t.editable.on("paste",e.onpaste),e.onToolbarClick&&t.toolbar.click(e.onToolbarClick),e.onChange){var i=function(){e.onChange(t.editable,t.editable.html())};if(r.isMSIE){var a="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";t.editable.on(a,i)}else t.editable.on("input",i)}t.editable.data("callbacks",{onAutoSave:e.onAutoSave,onImageUpload:e.onImageUpload,onImageUploadError:e.onImageUploadError,onFileUpload:e.onFileUpload,onFileUploadError:e.onFileUpload})},this.dettach=function(t,e){t.editable.off(),t.popover.off(),t.handle.off(),t.dialog.off(),e.airMode||(t.dropzone.off(),t.toolbar.off(),t.statusbar.off())}},k=function(){var e=function(t,e){var n=e.event,o=e.value,r=e.title,i=e.className,a=e.dropdown;return'<button type="button" class="btn btn-default btn-sm btn-small'+(i?" "+i:"")+(a?" dropdown-toggle":"")+'"'+(a?' data-toggle="dropdown"':"")+(r?' title="'+r+'"':"")+(n?' data-event="'+n+'"':"")+(o?" data-value='"+o+"'":"")+' tabindex="-1">'+t+(a?' <span class="caret"></span>':"")+"</button>"+(a||"")},n=function(t,n){var o='<i class="'+t+'"></i>';return e(o,n)},o=function(t,e){return'<div class="'+t+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content">'+e+"</div></div>"},a=function(t,e,n,o){return'<div class="'+t+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(e?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+e+"</h4></div>":"")+'<form class="note-modal-form"><div class="modal-body"><div class="row-fluid">'+n+"</div></div>"+(o?'<div class="modal-footer">'+o+"</div>":"")+"</form></div></div></div>"},s={picture:function(t){return n("fa fa-picture-o icon-picture",{event:"showImageDialog",title:t.image.image})},link:function(t){return n("fa fa-link icon-link",{event:"showLinkDialog",title:t.link.link})},video:function(t){return n("fa fa-youtube-play icon-play",{event:"showVideoDialog",title:t.video.video})},table:function(t){var e='<ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return n("fa fa-table icon-table",{title:t.table.table,dropdown:e})},style:function(t,e){var o=e.styleTags.reduce(function(e,n){var o=t.style["p"===n?"normal":n];return e+'<li><a data-event="formatBlock" href="#" data-value="'+n+'">'+("p"===n||"pre"===n?o:"<"+n+">"+o+"</"+n+">")+"</a></li>"},"");return n("fa fa-magic icon-magic",{title:t.style.style,dropdown:'<ul class="dropdown-menu">'+o+"</ul>"})},fontname:function(t,n){var o=n.fontNames.reduce(function(t,e){return r.isFontInstalled(e)?t+'<li><a data-event="fontName" href="#" data-value="'+e+'"><i class="fa fa-check icon-ok"></i> '+e+"</a></li>":t},""),i='<span class="note-current-fontname">'+n.defaultFontName+"</span>";return e(i,{title:t.font.name,dropdown:'<ul class="dropdown-menu">'+o+"</ul>"})},fontsize:function(t,n){var o=n.fontSizes.reduce(function(t,e){return t+'<li><a data-event="fontSize" href="#" data-value="'+e+'"><i class="fa fa-check icon-ok"></i> '+e+"</a></li>"},""),r='<span class="note-current-fontsize">11</span>';return e(r,{title:t.font.size,dropdown:'<ul class="dropdown-menu">'+o+"</ul>"})},color:function(t){var n='<i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i>',o=e(n,{className:"note-recent-color",title:t.color.recent,event:"color",value:'{"backColor":"yellow"}'}),r='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+t.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+t.color.transparent+'">'+t.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+t.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+t.color.reset+'">'+t.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>',i=e("",{title:t.color.more,dropdown:r});return o+i},bold:function(t){return n("fa fa-bold icon-bold",{event:"bold",title:t.font.bold})},italic:function(t){return n("fa fa-italic icon-italic",{event:"italic",title:t.font.italic})},underline:function(t){return n("fa fa-underline icon-underline",{event:"underline",title:t.font.underline})},strikethrough:function(t){return n("fa fa-strikethrough icon-strikethrough",{event:"strikethrough",title:t.font.strikethrough})},superscript:function(t){return n("fa fa-superscript icon-superscript",{event:"superscript",title:t.font.superscript})},subscript:function(t){return n("fa fa-subscript icon-subscript",{event:"subscript",title:t.font.subscript})},clear:function(t){return n("fa fa-eraser icon-eraser",{event:"removeFormat",title:t.font.clear})},ul:function(t){return n("fa fa-list-ul icon-list-ul",{event:"insertUnorderedList",title:t.lists.unordered})},ol:function(t){return n("fa fa-list-ol icon-list-ol",{event:"insertOrderedList",title:t.lists.ordered})},paragraph:function(t){var e=n("fa fa-align-left icon-align-left",{title:t.paragraph.left,event:"justifyLeft"}),o=n("fa fa-align-center icon-align-center",{title:t.paragraph.center,event:"justifyCenter"}),r=n("fa fa-align-right icon-align-right",{title:t.paragraph.right,event:"justifyRight"}),i=n("fa fa-align-justify icon-align-justify",{title:t.paragraph.justify,event:"justifyFull"}),a=n("fa fa-outdent icon-indent-left",{title:t.paragraph.outdent,event:"outdent"}),l=n("fa fa-indent icon-indent-right",{title:t.paragraph.indent,event:"indent"}),s='<div class="dropdown-menu"><div class="note-align btn-group">'+e+o+r+i+'</div><div class="note-list btn-group">'+l+a+"</div></div>";return n("fa fa-align-left icon-align-left",{title:t.paragraph.paragraph,dropdown:s})},height:function(t,e){var o=e.lineHeights.reduce(function(t,e){return t+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(e)+'"><i class="fa fa-check icon-ok"></i> '+e+"</a></li>"},"");return n("fa fa-text-height icon-text-height",{title:t.font.height,dropdown:'<ul class="dropdown-menu">'+o+"</ul>"})},help:function(t){return n("fa fa-question icon-question",{event:"showHelpDialog",title:t.options.help})},fullscreen:function(t){return n("fa fa-arrows-alt icon-fullscreen",{event:"fullscreen",title:t.options.fullscreen})},codeview:function(t){return n("fa fa-code icon-code",{event:"codeview",title:t.options.codeview})},undo:function(t){return n("fa fa-undo icon-undo",{event:"undo",title:t.history.undo})},redo:function(t){return n("fa fa-repeat icon-repeat",{event:"redo",title:t.history.redo})},hr:function(t){return n("fa fa-minus icon-hr",{event:"insertHorizontalRule",title:t.hr.insert})}},d=function(t,r){var i=function(){var e=n("fa fa-edit icon-edit",{title:t.link.edit,event:"showLinkDialog"}),r=n("fa fa-unlink icon-unlink",{title:t.link.unlink,event:"unlink"}),i='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+e+r+"</div>";return o("note-link-popover",i)},a=function(){var r=e('<span class="note-fontsize-10">100%</span>',{title:t.image.resizeFull,event:"resize",value:"1"}),i=e('<span class="note-fontsize-10">50%</span>',{title:t.image.resizeHalf,event:"resize",value:"0.5"}),a=e('<span class="note-fontsize-10">25%</span>',{title:t.image.resizeQuarter,event:"resize",value:"0.25"}),l=n("fa fa-align-left icon-align-left",{title:t.image.floatLeft,event:"floatMe",value:"left"}),s=n("fa fa-align-right icon-align-right",{title:t.image.floatRight,event:"floatMe",value:"right"}),d=n("fa fa-align-justify icon-align-justify",{title:t.image.floatNone,event:"floatMe",value:"none"}),c=n("fa fa-trash-o icon-trash",{title:t.image.remove,event:"removeMedia",value:"none"}),u='<div class="btn-group">'+r+i+a+'</div><div class="btn-group">'+l+s+d+'</div><div class="btn-group">'+c+"</div>";return o("note-image-popover",u)},l=function(){for(var e="",n=0,i=r.airPopover.length;i>n;n++){var a=r.airPopover[n];e+='<div class="note-'+a[0]+' btn-group">';for(var l=0,d=a[1].length;d>l;l++)e+=s[a[1][l]](t,r);e+="</div>"}return o("note-air-popover",e)};return'<div class="note-popover">'+i()+a()+(r.airMode?l():"")+"</div>"},c=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},u=function(t,e){return'<table class="note-shortcut"><thead><tr><th></th><th>'+t+"</th></tr></thead><tbody>"+e+"</tbody></table>"},f=function(t){var e="<tr><td>⌘ + B</td><td>"+t.font.bold+"</td></tr><tr><td>⌘ + I</td><td>"+t.font.italic+"</td></tr><tr><td>⌘ + U</td><td>"+t.font.underline+"</td></tr><tr><td>⌘ + ⇧ + S</td><td>"+t.font.strikethrough+"</td></tr><tr><td>⌘ + \\</td><td>"+t.font.clear+"</td></tr>";return u(t.shortcut.textFormatting,e)},h=function(t){var e="<tr><td>⌘ + Z</td><td>"+t.history.undo+"</td></tr><tr><td>⌘ + ⇧ + Z</td><td>"+t.history.redo+"</td></tr><tr><td>⌘ + ]</td><td>"+t.paragraph.indent+"</td></tr><tr><td>⌘ + [</td><td>"+t.paragraph.outdent+"</td></tr><tr><td>⌘ + ENTER</td><td>"+t.hr.insert+"</td></tr>";return u(t.shortcut.action,e)},v=function(t){var e="<tr><td>⌘ + ⇧ + L</td><td>"+t.paragraph.left+"</td></tr><tr><td>⌘ + ⇧ + E</td><td>"+t.paragraph.center+"</td></tr><tr><td>⌘ + ⇧ + R</td><td>"+t.paragraph.right+"</td></tr><tr><td>⌘ + ⇧ + J</td><td>"+t.paragraph.justify+"</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>"+t.lists.ordered+"</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>"+t.lists.unordered+"</td></tr>";return u(t.shortcut.paragraphFormatting,e)},p=function(t){var e="<tr><td>⌘ + NUM0</td><td>"+t.style.normal+"</td></tr><tr><td>⌘ + NUM1</td><td>"+t.style.h1+"</td></tr><tr><td>⌘ + NUM2</td><td>"+t.style.h2+"</td></tr><tr><td>⌘ + NUM3</td><td>"+t.style.h3+"</td></tr><tr><td>⌘ + NUM4</td><td>"+t.style.h4+"</td></tr><tr><td>⌘ + NUM5</td><td>"+t.style.h5+"</td></tr><tr><td>⌘ + NUM6</td><td>"+t.style.h6+"</td></tr>";return u(t.shortcut.documentStyle,e)},g=function(t,e){var n=e.extraKeys,o="";for(var r in n)n.hasOwnProperty(r)&&(o+="<tr><td>"+r+"</td><td>"+n[r]+"</td></tr>");return u(t.shortcut.extraKeys,o)},m=function(t,e){var n='<table class="note-shortcut-layout"><tbody><tr><td>'+h(t,e)+"</td><td>"+f(t,e)+"</td></tr><tr><td>"+p(t,e)+"</td><td>"+v(t,e)+"</td></tr>";return e.extraKeys&&(n+='<tr><td colspan="2">'+g(t,e)+"</td></tr>"),n+="</tbody</table>"},b=function(t){return t.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")},y=function(t,e){var n=function(){var e="<h5>"+t.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+t.image.url+'</h5><input class="note-image-url form-control span12" type="text" />',n='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+t.image.insert+"</button>";return a("note-image-dialog",t.image.insert,e,n)},o=function(){var n='<div class="form-group"><label>'+t.link.textToDisplay+'</label><input class="note-link-text form-control span12" type="text" /></div><div class="form-group"><label>'+t.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(e.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+t.link.openInNewWindow+"</label></div>"),o='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+t.link.insert+"</button>";return a("note-link-dialog",t.link.insert,n,o)},i=function(){var e='<div class="form-group"><label>'+t.video.url+'</label>&nbsp;<small class="text-muted">'+t.video.providers+'</small><input class="note-video-url form-control span12" type="text" /></div>',n='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+t.video.insert+"</button>";return a("note-video-dialog",t.video.insert,e,n)},l=function(){var n='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+t.shortcut.close+'</a><div class="title">'+t.shortcut.shortcuts+"</div>"+(r.isMac?m(t,e):b(m(t,e)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.3</a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p>';return a("note-help-dialog","",n,"")};return'<div class="note-dialog">'+n()+o()+i()+l()+"</div>"},C=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'},w=function(t){return r.isMac&&(t=t.replace("CMD","⌘").replace("SHIFT","⇧")),t.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")},k=function(e,n,o){var r=i.invertObject(n),a=e.find("button");a.each(function(e,n){var o=t(n),i=r[o.data("event")];i&&o.attr("title",function(t,e){return e+" ("+w(i)+")"})}).tooltip({container:"body",trigger:"hover",placement:o||"top"}).on("click",function(){t(this).tooltip("hide")})},T=function(e,n){var o=n.colors;e.find(".note-color-palette").each(function(){for(var e=t(this),n=e.attr("data-target-event"),r=[],i=0,a=o.length;a>i;i++){for(var l=o[i],s=[],d=0,c=l.length;c>d;d++){var u=l[d];s.push(['<button type="button" class="note-color-btn" style="background-color:',u,';" data-event="',n,'" data-value="',u,'" title="',u,'" data-toggle="button" tabindex="-1"></button>'].join(""))}r.push('<div class="note-color-row">'+s.join("")+"</div>")}e.html(r.join(""))})};this.createLayoutByAirMode=function(e,n){var o=n.keyMap[r.isMac?"mac":"pc"],a=t.summernote.lang[n.lang],l=i.uniqueId();e.addClass("note-air-editor note-editable"),e.attr({id:"note-editor-"+l,contentEditable:!0});var s=document.body,u=t(d(a,n));u.addClass("note-air-layout"),u.attr("id","note-popover-"+l),u.appendTo(s),k(u,o),T(u,n);var f=t(c());f.addClass("note-air-layout"),f.attr("id","note-handle-"+l),f.appendTo(s);var h=t(y(a,n));h.addClass("note-air-layout"),h.attr("id","note-dialog-"+l),h.find("button.close, a.modal-close").click(function(){t(this).closest(".modal").modal("hide")}),h.appendTo(s)},this.createLayoutByFrame=function(e,n){var o=t('<div class="note-editor"></div>');n.width&&o.width(n.width),n.height>0&&t('<div class="note-statusbar">'+(n.disableResizeEditor?"":C())+"</div>").prependTo(o);var i=!e.is(":disabled"),a=t('<div class="note-editable" contentEditable="'+i+'"></div>').prependTo(o);n.height&&a.height(n.height),n.direction&&a.attr("dir",n.direction),a.html(l.html(e)||l.emptyPara),t('<textarea class="note-codable"></textarea>').prependTo(o);for(var u=t.summernote.lang[n.lang],f="",h=0,v=n.toolbar.length;v>h;h++){var p=n.toolbar[h][0],g=n.toolbar[h][1];f+='<div class="note-'+p+' btn-group">';for(var m=0,b=g.length;b>m;m++)t.isFunction(s[g[m]])&&(f+=s[g[m]](u,n));f+="</div>"}f='<div class="note-toolbar btn-toolbar">'+f+"</div>";var w=t(f).prependTo(o),x=n.keyMap[r.isMac?"mac":"pc"];T(w,n),k(w,x,"bottom");var F=t(d(u,n)).prependTo(o);T(F,n),k(F,x),t(c()).prependTo(o);var S=t(y(u,n)).prependTo(o);S.find("button.close, a.modal-close").click(function(){t(this).closest(".modal").modal("hide")}),t('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(o),o.insertAfter(e),e.hide()},this.noteEditorFromHolder=function(e){return e.hasClass("note-air-editor")?e:e.next().hasClass("note-editor")?e.next():t()},this.createLayout=function(t,e){this.noteEditorFromHolder(t).length||(e.airMode?this.createLayoutByAirMode(t,e):this.createLayoutByFrame(t,e))},this.layoutInfoFromHolder=function(t){var e=this.noteEditorFromHolder(t);if(e.length){var n=l.buildLayoutInfo(e);for(var o in n)n.hasOwnProperty(o)&&(n[o]=n[o].call());return n}},this.removeLayout=function(t,e,n){n.airMode?(t.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),e.popover.remove(),e.handle.remove(),e.dialog.remove()):(t.html(e.editable.html()),e.editor.remove(),t.show())}};t.summernote=t.summernote||{},t.extend(t.summernote,s);var T=new k,x=new w;t.fn.extend({summernote:function(e){if(e=t.extend({},t.summernote.options,e),this.each(function(n,o){var r=t(o);T.createLayout(r,e);var i=T.layoutInfoFromHolder(r);x.attach(i,e),l.isTextarea(r[0])&&r.closest("form").submit(function(){r.val(r.code())})}),this.first().length&&e.focus){var n=T.layoutInfoFromHolder(this.first());n.editable.focus()}return this.length&&e.oninit&&e.oninit(),this},code:function(e){if(void 0===e){var n=this.first();if(!n.length)return;var o=T.layoutInfoFromHolder(n);if(o&&o.editable){var i=o.editor.hasClass("codeview");return i&&r.hasCodeMirror&&o.codable.data("cmEditor").save(),i?o.codable.val():o.editable.html()}return l.isTextarea(n[0])?n.val():n.html()}return this.each(function(n,o){var r=T.layoutInfoFromHolder(t(o));r&&r.editable&&r.editable.html(e)}),this},destroy:function(){return this.each(function(e,n){var o=t(n),r=T.layoutInfoFromHolder(o);if(r&&r.editable){var i=r.editor.data("options");x.dettach(r,i),T.removeLayout(o,r,i)}}),this}})});